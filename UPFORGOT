import React, { useState } from "react";

import { useNavigate } from "react-router-dom";

import "./LoginPage.css";

import "../App.css";



function ForgotPasswordPage() {

  const [userId, setUserId] = useState("");

  const [newPassword, setNewPassword] = useState("");

  const [confirmPassword, setConfirmPassword] = useState("");

  const navigate = useNavigate();



  const handleReset = async (e) => {

    e.preventDefault();



    if (!userId || !newPassword || !confirmPassword) {

      alert("Please fill all fields.");

      return;

    }



    if (newPassword !== confirmPassword) {

      alert("Passwords do not match.");

      return;

    }



    try {

      const response = await fetch("http://localhost:8080/api/forgot-password", {

        method: "PUT",

        headers: { "Content-Type": "application/json" },

        body: JSON.stringify({ userId, newPassword }),

      });



      if (!response.ok) {

        const err = await response.text();

        throw new Error(err || "Reset failed");

      }



      alert("Password reset successful! You can now log in with your new password.");

      navigate("/"); // redirect to login

    } catch (error) {

      alert("Reset failed: " + error.message);

    }

  };



  return (

    <div

      className="login-container"

      style={{ backgroundImage: `url(/images/bg_1.jpeg)` }}

    >

      <div className="main-content" style={{ justifyContent: "center" }}>

        <div className="login-box">

          <h2>Reset Your Password</h2>

          <form onSubmit={handleReset}>

            <input

              type="text"

              placeholder="Enter User ID"

              value={userId}

              onChange={(e) => setUserId(e.target.value)}

              required

            />

            <input

              type="password"

              placeholder="Enter New Password"

              value={newPassword}

              onChange={(e) => setNewPassword(e.target.value)}

              required

            />

            <input

              type="password"

              placeholder="Confirm New Password"

              value={confirmPassword}

              onChange={(e) => setConfirmPassword(e.target.value)}

              required

            />

            <button type="submit" className="login-btn">

              Reset Password

            </button>

          </form>

          <p>

            <a onClick={() => navigate("/")} className="link-btn">

              Back to Login

            </a>

          </p>

        </div>

      </div>

    </div>

  );

}



export default ForgotPasswordPage;
